---
title: ginçš„ä¸­é—´ä»¶æœºåˆ¶
categories: Golang
tags:
  - Golang
  - ä¸­é—´ä»¶
cover: 'https://www.loliapi.com/acg?89'
abbrlink: 44434
date: 2025-09-27 15:19:44
---

## ä¸­é—´ä»¶çš„æ¦‚å¿µå’ŒåŸç†

### What is ä¸­é—´ä»¶

åœ¨Webåº”ç”¨å¼€å‘ä¸­ï¼Œä¸­é—´ä»¶ï¼ˆMiddlewareï¼‰æ˜¯ä½äºåº”ç”¨ç¨‹åºä¸æœåŠ¡å™¨ä¹‹é—´çš„è½¯ä»¶ç»„ä»¶ï¼Œèƒ½å¤Ÿæ‹¦æˆªHTTPè¯·æ±‚å’Œå“åº”ï¼Œå¹¶æ‰§è¡Œç‰¹å®šçš„é€»è¾‘å¤„ç†ã€‚
è¯´é€šä¿—ä¸€ç‚¹å°±æ˜¯ï¼Œåœ¨å¼€å§‹åšä½ çœŸæ­£æƒ³åšçš„äº‹ä¹‹å‰ï¼Œè¦æŠŠä¸€äº›æ‚æ´»å…ˆå¹²å®Œã€‚ä¾‹å¦‚é‰´æƒç™»å½•ã€èº«ä»½éªŒè¯ã€æ—¥å¿—è®°å½•ç­‰ç­‰ç­‰ç­‰ã€‚

### Why is ä¸­é—´ä»¶

ä¸­é—´ä»¶çš„æ ¸å¿ƒæ€æƒ³æ˜¯ **åˆ†å±‚å¤„ç†** å’Œ **èŒè´£åˆ†ç¦»**ã€‚
é€šè¿‡å°†é€šç”¨çš„ã€ä¸ä¸šåŠ¡æ— å…³çš„é€»è¾‘æŠ½è±¡å‡ºæ¥ï¼Œæ”¾åœ¨ä¸­é—´ä»¶ä¸­å¤„ç†ï¼Œå¯ä»¥è®©ä¸šåŠ¡ä»£ç æ›´åŠ  ç®€æ´ã€ä¸“æ³¨ã€æ˜“äºç»´æŠ¤ã€‚
åŒæ—¶ï¼Œä¸­é—´ä»¶é‡‡ç”¨ é“¾å¼è°ƒç”¨ çš„æ–¹å¼ï¼Œå½¢æˆä¸€ä¸ªå¤„ç†ç®¡é“ï¼Œè¯·æ±‚ä¾æ¬¡ç»è¿‡å„ä¸ªä¸­é—´ä»¶ï¼Œæ¯ä¸ªä¸­é—´ä»¶éƒ½å¯ä»¥åœ¨è¯·æ±‚åˆ°è¾¾ä¸šåŠ¡é€»è¾‘ä¹‹å‰æˆ–ä¹‹åæ‰§è¡Œç‰¹å®šçš„æ“ä½œã€‚
è¿™æ ·åšä¸€å®šç¨‹åº¦ä¸Šå¯ä»¥é¿å…å±å±±äº§ç”Ÿï¼Œå¯¹äºæ•´ä¸ªé¡¹ç›®çš„æ¶æ„å’Œå¯æ‹“å±•æ€§èµ·ç€å¾ˆé‡è¦çš„ä½œç”¨ã€‚

### How is ä¸­é—´ä»¶

Ginçš„ä¸­é—´ä»¶å·¥ä½œåŸç†åŸºäºè´£ä»»é“¾æ¨¡å¼ï¼ˆChain of Responsibility Patternï¼‰ã€‚è¿™ç§è®¾è®¡æ¨¡å¼å…è®¸å¤šä¸ªå¤„ç†å™¨ä¾æ¬¡å¤„ç†åŒä¸€ä¸ªè¯·æ±‚ï¼Œæ¯ä¸ªå¤„ç†å™¨ä¸“æ³¨äºè‡ªå·±çš„èŒè´£é¢†åŸŸã€‚
è¯´ç™½äº†å°±æ˜¯æŒ¨ä¸ªé—®ä¸€éï¼Œè°èƒ½å¹²è°å¹²ï¼Œå¹²ä¸äº†å°±ç”©ç»™ä¸‹å®¶ã€‚æ¯ä¸€å±‚åªå…³å¿ƒè‡ªå·±é‚£ä¸€æ¡£å­äº‹ï¼Œèƒ½å¤„ç†å°±å¤„ç†ï¼Œä¸èƒ½å¤„ç†å°±æŠŠä¸šåŠ¡åŸå°ä¸åŠ¨å¾€ä¸‹ä¼ ï¼Œç›´åˆ°æœ‰äººæå®šä¸ºæ­¢ã€‚ï¼ˆåƒæäº†æŸäº›æ•ˆç‡ä½ä¸‹çš„è‡ƒè‚¿å›¢é˜Ÿï¼‰

åœ¨Ginä¸­ï¼Œæ¯ä¸ªä¸­é—´ä»¶å¯ä»¥æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š

- å‰ç½®æ“ä½œï¼šåœ¨è¯·æ±‚å¤„ç†å‰æ‰§è¡ŒæŸäº›é€»è¾‘
- æµç¨‹æ§åˆ¶ï¼šé€šè¿‡è°ƒç”¨c.Next()å°†æ§åˆ¶æƒä¼ é€’ç»™ä¸‹ä¸€ä¸ªä¸­é—´ä»¶
- åç½®æ“ä½œï¼šåœ¨ä¸‹æ¸¸ä¸­é—´ä»¶æ‰§è¡Œå®Œæ¯•åç»§ç»­æ‰§è¡Œæ“ä½œ
- ä¸­æ–­å¤„ç†ï¼šé€šè¿‡è°ƒç”¨c.Abort()ç»ˆæ­¢åç»­ä¸­é—´ä»¶çš„æ‰§è¡Œ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                            HTTPè¯·æ±‚                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ä¸­é—´ä»¶1å‰ç½®é€»è¾‘ï¼ˆå¦‚ï¼šè¯·æ±‚æ—¥å¿—è®°å½•å¼€å§‹ï¼‰                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â”‚  c.Next()è°ƒç”¨
                                â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                ä¸­é—´ä»¶2å‰ç½®é€»è¾‘ï¼ˆå¦‚ï¼šèº«ä»½éªŒè¯ï¼‰                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â”‚  c.Next()è°ƒç”¨
                                â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                æœ€ç»ˆå¤„ç†å‡½æ•°ï¼ˆå¦‚ï¼šè·å–ç”¨æˆ·åˆ—è¡¨ï¼‰                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â”‚  å¤„ç†å‡½æ•°è¿”å›
                                â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 ä¸­é—´ä»¶2åç½®é€»è¾‘ï¼ˆå¦‚ï¼šè®°å½•æ“ä½œæ—¥å¿—ï¼‰                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â”‚  è¿”å›åˆ°ä¸­é—´ä»¶1
                                â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               ä¸­é—´ä»¶1åç½®é€»è¾‘ï¼ˆå¦‚ï¼šè®¡ç®—å“åº”æ—¶é—´ï¼‰                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          HTTPå“åº”                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```
## Gin ä¸­é—´ä»¶çš„ç±»å‹
1. å…¨å±€ä¸­é—´ä»¶ï¼šåº”ç”¨äºæ‰€æœ‰è·¯ç”±ï¼Œåœ¨ä»»ä½•è·¯ç”±å¤„ç†ä¹‹å‰æ‰§è¡Œã€‚
```golang
// å…¨å±€ä¸­é—´ä»¶ï¼šåº”ç”¨äºæ‰€æœ‰è·¯ç”±
router.Use(Logger())
```
2. è·¯ç”±ç»„ä¸­é—´ä»¶ï¼šåªåº”ç”¨äºç‰¹å®šè·¯ç”±ç»„å†…çš„è·¯ç”±
```golang
// è·¯ç”±ç»„ä¸­é—´ä»¶ï¼šåªåº”ç”¨äºauthorizedç»„
authorized := router.Group("/")
authorized.Use(AuthRequired())
```
3. å•ä¸ªè·¯ç”±ä¸­é—´ä»¶
```golang
// å•ä¸ªè·¯ç”±ä¸­é—´ä»¶ï¼šåªåº”ç”¨äºæ­¤è·¯ç”±
router.GET("/benchmark", MyBenchLogger(), benchEndpoint)
```

## Gin å†…ç½®çš„ä¸­é—´ä»¶

Gin æ¡†æ¶è™½ç„¶ä»¥â€œè½»é‡â€è‘—ç§°ï¼Œä½†ä¹Ÿè´´å¿ƒåœ°æä¾›äº†ä¸€äº›**å¼€ç®±å³ç”¨çš„ä¸­é—´ä»¶**ï¼Œå¸®åŠ©å¼€å‘è€…å¿«é€Ÿå®ç°å¸¸è§åŠŸèƒ½ã€‚è¿™äº›ä¸­é—´ä»¶éƒ½ä½äº `gin` åŒ…æˆ–å®˜æ–¹æ‰©å±•åº“ `github.com/gin-contrib` ä¸­ã€‚

### 1. `Logger()` â€”â€” è¯·æ±‚æ—¥å¿—è®°å½•
è¿™æ˜¯æœ€å¸¸ç”¨çš„ä¸­é—´ä»¶ä¹‹ä¸€ï¼Œè‡ªåŠ¨è®°å½•æ¯ä¸ª HTTP è¯·æ±‚çš„åŸºæœ¬ä¿¡æ¯ï¼ˆæ–¹æ³•ã€è·¯å¾„ã€çŠ¶æ€ç ã€è€—æ—¶ç­‰ï¼‰ã€‚

```go
router.Use(gin.Logger())
```

è¾“å‡ºç¤ºä¾‹ï¼š
```
[GIN] 2025/09/27 - 15:30:45 | 200 |    1.2ms |       127.0.0.1 | GET      "/api/users"
```

> ğŸ’¡ æç¤ºï¼šç”Ÿäº§ç¯å¢ƒä¸­æ›´æ¨èä½¿ç”¨ç»“æ„åŒ–æ—¥å¿—ï¼ˆå¦‚ `zap` + è‡ªå®šä¹‰ä¸­é—´ä»¶ï¼‰ï¼Œä½†å¼€å‘é˜¶æ®µ `Logger()` è¶³å¤Ÿå¥½ç”¨ã€‚

---

### 2. `Recovery()` â€”â€” å´©æºƒæ¢å¤
å½“ä½ çš„ handler ä¸­å‘ç”Ÿ panic æ—¶ï¼Œ`Recovery()` èƒ½æ•è·å¼‚å¸¸ï¼Œé˜²æ­¢æ•´ä¸ªæœåŠ¡å´©æºƒï¼Œå¹¶è¿”å› 500 é”™è¯¯ã€‚

```go
router.Use(gin.Recovery())
```

é»˜è®¤ä¼šæ‰“å° panic å †æ ˆåˆ° stderrï¼Œä½ ä¹Ÿå¯ä»¥è‡ªå®šä¹‰æ¢å¤é€»è¾‘ï¼š

```go
router.Use(gin.CustomRecovery(func(c *gin.Context, recovered interface{}) {
    c.String(500, "æœåŠ¡å™¨å¼€å°å·®äº†ï¼Œè¯·ç¨åå†è¯•~")
}))
```

---

### 3. å…¶ä»–å¸¸ç”¨å®˜æ–¹ä¸­é—´ä»¶ï¼ˆæ¥è‡ª `gin-contrib`ï¼‰

Gin å®˜æ–¹ç»´æŠ¤äº†ä¸€ç³»åˆ—é«˜è´¨é‡ä¸­é—´ä»¶ï¼Œéœ€å•ç‹¬å®‰è£…ï¼š

```bash
go get github.com/gin-contrib/cors
go get github.com/gin-contrib/static
go get github.com/gin-contrib/sse
```

| ä¸­é—´ä»¶ | ä½œç”¨ |
|--------|------|
| `cors` | å¤„ç†è·¨åŸŸè¯·æ±‚ï¼ˆCORSï¼‰ |
| `static` | æä¾›é™æ€æ–‡ä»¶æœåŠ¡ï¼ˆå¦‚å‰ç«¯èµ„æºï¼‰ |
| `gzip` | è‡ªåŠ¨å‹ç¼©å“åº”ä½“ï¼ˆèŠ‚çœå¸¦å®½ï¼‰ |
| `secure` | æ·»åŠ å®‰å…¨ç›¸å…³çš„ HTTP å¤´ï¼ˆå¦‚ XSS ä¿æŠ¤ï¼‰ |
| `timeout` | ä¸ºè·¯ç”±è®¾ç½®è¶…æ—¶æ§åˆ¶ |

**ç¤ºä¾‹ï¼šå¯ç”¨ CORS**
```go
import "github.com/gin-contrib/cors"

router.Use(cors.Default()) // å…è®¸æ‰€æœ‰æ¥æºï¼ˆä»…å¼€å‘ç¯å¢ƒï¼ï¼‰
```

> âš ï¸ æ³¨æ„ï¼š`cors.Default()` ä»…ç”¨äºå¼€å‘ï¼ç”Ÿäº§ç¯å¢ƒåº”é…ç½®å…·ä½“åŸŸåã€‚

---

## è‡ªå®šä¹‰ä¸­é—´ä»¶å®æˆ˜

ä¸­é—´ä»¶çš„æœ¬è´¨å°±æ˜¯ä¸€ä¸ª **`func(c *gin.Context)`** ç±»å‹çš„å‡½æ•°ã€‚ä¸‹é¢é€šè¿‡å‡ ä¸ªä¾‹å­å±•ç¤ºå¦‚ä½•ç¼–å†™å®ç”¨ä¸­é—´ä»¶ã€‚

### ç¤ºä¾‹ 1ï¼šé‰´æƒä¸­é—´ä»¶ï¼ˆAuthRequiredï¼‰

```go
func AuthRequired() gin.HandlerFunc {
    return func(c *gin.Context) {
        token := c.GetHeader("Authorization")
        if token != "Bearer secret123" {
            c.AbortWithStatusJSON(401, gin.H{
                "error": "æœªæˆæƒï¼Œè¯·æä¾›æœ‰æ•ˆ token",
            })
            return
        }
        // éªŒè¯é€šè¿‡ï¼Œç»§ç»­
        c.Next()
    }
}
```

ä½¿ç”¨ï¼š
```go
admin := router.Group("/admin")
admin.Use(AuthRequired())
{
    admin.GET("/users", listUsers)
}
```

---

### ç¤ºä¾‹ 2ï¼šè¯·æ±‚è€—æ—¶ç»Ÿè®¡ä¸­é—´ä»¶

```go
func RequestTime() gin.HandlerFunc {
    return func(c *gin.Context) {
        start := time.Now()
        
        c.Next() // ç­‰å¾…ä¸‹æ¸¸å¤„ç†å®Œæˆ
        
        duration := time.Since(start)
        c.Header("X-Response-Time", duration.String())
        log.Printf("[%s] %s %s â†’ %v", 
            c.Request.Method, 
            c.Request.URL.Path, 
            c.Writer.Status(), 
            duration)
    }
}
```

è¿™ä¸ªä¸­é—´ä»¶ä¼šåœ¨å“åº”å¤´ä¸­åŠ å…¥ `X-Response-Time`ï¼ŒåŒæ—¶æ‰“å°æ—¥å¿—ï¼Œæ–¹ä¾¿æ€§èƒ½åˆ†æã€‚

---

### ç¤ºä¾‹ 3ï¼šé˜²é‡å¤æäº¤ï¼ˆåŸºäºå†…å­˜ + è¿‡æœŸæ—¶é—´ï¼‰

```go
var (
    requestCache = make(map[string]time.Time)
    cacheMutex   = sync.RWMutex{}
)

func PreventDuplicateRequest() gin.HandlerFunc {
    return func(c *gin.Context) {
        key := c.ClientIP() + c.Request.URL.Path + c.Request.UserAgent()
        
        cacheMutex.Lock()
        defer cacheMutex.Unlock()
        
        if t, exists := requestCache[key]; exists && time.Since(t) < 2*time.Second {
            c.AbortWithStatusJSON(429, gin.H{"error": "è¯·æ±‚å¤ªé¢‘ç¹ï¼Œè¯·ç¨åå†è¯•"})
            return
        }
        requestCache[key] = time.Now()
        c.Next()
    }
}
```

## ä¸­é—´ä»¶ä½¿ç”¨å®è·µ

###  1. **ä¸­é—´ä»¶é¡ºåºå¾ˆé‡è¦ï¼**
Gin ä¸­é—´ä»¶æ˜¯**ä»æ³¨å†Œé¡ºåºä¾æ¬¡æ‰§è¡Œå‰ç½®é€»è¾‘ï¼Œå†é€†åºæ‰§è¡Œåç½®é€»è¾‘**ã€‚ä¾‹å¦‚ï¼š

```go
router.Use(Logger(), Recovery(), AuthRequired())
```

æ‰§è¡Œé¡ºåºï¼š
1. Logger å‰ç½®
2. Recovery å‰ç½®
3. AuthRequired å‰ç½®
4. Handler æ‰§è¡Œ
5. AuthRequired åç½®ï¼ˆå‡ ä¹æ²¡æœ‰ï¼‰
6. Recovery åç½®ï¼ˆå¤„ç† panicï¼‰
7. Logger åç½®ï¼ˆè®°å½•è€—æ—¶ï¼‰

> å»ºè®®é¡ºåºï¼š`Recovery â†’ Logger â†’ Auth â†’ RateLimit â†’ Handler`

---

### 2. **ä¸è¦æ»¥ç”¨å…¨å±€ä¸­é—´ä»¶**
å…¨å±€ä¸­é—´ä»¶ä¼šå¯¹**æ¯ä¸€ä¸ªè¯·æ±‚**ç”Ÿæ•ˆï¼ŒåŒ…æ‹¬é™æ€èµ„æºã€å¥åº·æ£€æŸ¥ç­‰ã€‚ä¸å¿…è¦çš„ä¸­é—´ä»¶ä¼šæ‹–æ…¢æ€§èƒ½ã€‚

**åä¾‹ï¼š**
```go
router.Use(AuthRequired()) // æ‰€æœ‰è·¯ç”±éƒ½è¦ç™»å½•ï¼ŸåŒ…æ‹¬ /healthï¼Ÿ
```

**æ­£ä¾‹ï¼š**
```go
api := router.Group("/api")
api.Use(AuthRequired()) // åªä¿æŠ¤ API è·¯ç”±
```

---

### 3. **ä¸­é—´ä»¶åº”å°½é‡æ— çŠ¶æ€ã€å¹‚ç­‰**
é¿å…åœ¨ä¸­é—´ä»¶ä¸­ä¿®æ”¹è¯·æ±‚ä½“ï¼ˆ`c.Request.Body` åªèƒ½è¯»ä¸€æ¬¡ï¼‰ï¼Œå¦‚éœ€å¤šæ¬¡è¯»å–ï¼Œå¯ä½¿ç”¨ `c.GetRawData()` æˆ–å°è£… `io.TeeReader`ã€‚

---

### 4. **åˆç†ä½¿ç”¨ c.Abort() å’Œ c.Next()**
- `c.Next()`ï¼šç»§ç»­æ‰§è¡Œä¸‹ä¸€ä¸ªä¸­é—´ä»¶ï¼ˆé€šå¸¸æ”¾åœ¨å‰ç½®é€»è¾‘åï¼‰
- `c.Abort()`ï¼šç«‹å³ç»ˆæ­¢åç»­ä¸­é—´ä»¶å’Œ handlerï¼ˆå¸¸ç”¨äºé‰´æƒå¤±è´¥ï¼‰
- `c.AbortWithStatusJSON()`ï¼šç»ˆæ­¢å¹¶è¿”å› JSON å“åº”ï¼ˆæ¨èï¼‰

---


Gin çš„ä¸­é—´ä»¶æœºåˆ¶æ˜¯å…¶å¼ºå¤§çµæ´»æ€§çš„æ ¸å¿ƒä¹‹ä¸€ã€‚å®ƒç”¨æç®€çš„ API å®ç°äº†å¼ºå¤§çš„**è¯·æ±‚å¤„ç†ç®¡é“**ï¼Œè®©å¼€å‘è€…å¯ä»¥åƒæ­ç§¯æœ¨ä¸€æ ·ç»„åˆåŠŸèƒ½ã€‚

- **ç†è§£è´£ä»»é“¾æ¨¡å¼**æ˜¯æŒæ¡ä¸­é—´ä»¶çš„å…³é”®ï¼›
- **å–„ç”¨å†…ç½®ä¸­é—´ä»¶**èƒ½å¿«é€Ÿæ­å»ºåŸºç¡€èƒ½åŠ›ï¼›
- **è‡ªå®šä¹‰ä¸­é—´ä»¶**è®©ä½ è½»æ¾é›†æˆä¸šåŠ¡é€»è¾‘ï¼›
- **æ³¨æ„é¡ºåºä¸æ€§èƒ½**ï¼Œé¿å…â€œä¸­é—´ä»¶é™·é˜±â€ã€‚

å½“ä½ èƒ½æŠŠæ—¥å¿—ã€é‰´æƒã€é™æµã€ç›‘æ§ç­‰æ¨ªåˆ‡å…³æ³¨ç‚¹ä¼˜é›…åœ°å°è£…è¿›ä¸­é—´ä»¶ï¼Œä½ çš„ Go é¡¹ç›®å°±å·²ç»èµ°åœ¨äº†**æ¸…æ™°ã€å¯ç»´æŠ¤ã€å¯æ‰©å±•**çš„æ­£é“ä¸Šã€‚

>   
> ğŸŒˆ **â€œå¥½çš„ä¸­é—´ä»¶ï¼Œè®©ä¸šåŠ¡ä»£ç åªå…³å¿ƒä¸šåŠ¡ã€‚â€**

---

**å‚è€ƒé“¾æ¥ï¼š**
- [Gin å®˜æ–¹æ–‡æ¡£ - Middleware](https://gin-gonic.com/docs/middleware/)
- [gin-contrib ä¸­é—´ä»¶ä»“åº“](https://github.com/gin-contrib)
- [ginæ¡†æ¶ä»å…¥é—¨åˆ°ç²¾é€š](https://blog.csdn.net/gophertribe/article/details/146546615)
---